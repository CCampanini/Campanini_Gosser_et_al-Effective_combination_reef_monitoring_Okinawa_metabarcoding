---
title: "Relative cover analysis"
author: "Claudia Campanini"
date: 
output: 
  html_document: 
    toc: yes
    number_sections: yes
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load some basic libraries

```{r}
library(dplyr)
library(ggplot2)
library(readxl)   # to import excel datasets
```
# MEAN RELATIVE BENTHIC COVERBY CATEGORY

Load input file 

```{r}
cov_df <- read_excel("plits_ext_df.xlsx")
str(cov_df)
```
## PER SITE
Follow the link for explanation of dcast function https://seananderson.ca/2013/10/19/reshape/

```{r}
mean_rel_cov_site <- cov_df %>%
  group_by(Site, Category) %>%
  summarise(Mean_rel_cov=round(mean(Rel_cov),2))

mean_rel_cov_site <- dcast(mean_rel_cov_site, Site ~ Category)
```
## PER SITE WITHIN DEPTH

```{r}
mean_rel_cov_df <- cov_df %>%
  group_by(Site_depth, Category) %>%
  summarise(Mean_rel_cov=round(mean(Rel_cov),2))

Site_depth <- mean_rel_cov_df$Site_depth

mean_rel_cov_df <- mean_rel_cov_df %>%
  separate_wider_delim(Site_depth, "_", names = c("Site", "Depth")) %>%
  mutate(Site_depth=Site_depth)

mean_rel_cov_wide <- dcast(mean_rel_cov_df, Site_depth ~ Category)
mean_rel_cov_wide
```

## STACKED BARPLOTS

